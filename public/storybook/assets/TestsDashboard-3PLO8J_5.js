import{j as n}from"./jsx-runtime-BjG_zV1W.js";import{useMDXComponents as P}from"./index-Di0Mt_3y.js";import{M as J}from"./index-Dd9QK8Sf.js";import{R as e}from"./index-R2V08a_e.js";import"./iframe-D4bCNOrd.js";import"./index-B25VQ0Mk.js";import"./index-BMU9HDYU.js";import"./index-DrFu-skq.js";const L=()=>{var j,T,w;const[t,r]=e.useState(null),[o,A]=e.useState(null),[y,R]=e.useState([]),[s,D]=e.useState(null);e.useEffect(()=>{let a=!0;return(async()=>{try{const i=await fetch("/data/tests/jest-summary.json",{cache:"no-store"});a&&i.ok&&r(await i.json())}catch{}try{const i=await fetch("/data/tests/playwright-summary.json",{cache:"no-store"});if(a&&i.ok){const c=await i.json();if(a){A(c);const x=[],f=u=>{var b;if(u&&(Array.isArray(u.suites)&&u.suites.forEach(f),Array.isArray(u.specs)))for(const l of u.specs){const M=(l==null?void 0:l.title)||(l==null?void 0:l.name)||"Unknown spec",N=(l==null?void 0:l.file)||((b=l==null?void 0:l.location)==null?void 0:b.file),C=(l==null?void 0:l.tests)||[];let S=!1,h;for(const v of C)for(const m of(v==null?void 0:v.results)||[])if((m==null?void 0:m.status)==="failed"){S=!0;const d=(m==null?void 0:m.errors)&&m.errors[0]||(m==null?void 0:m.error)||void 0;h=typeof d=="string"?d:(d==null?void 0:d.message)||(d==null?void 0:d.stack)||h}S&&x.push({title:M,file:N,error:h})}};Array.isArray(c==null?void 0:c.suites)&&c.suites.forEach(f),Array.isArray(c==null?void 0:c.projects)&&c.projects.forEach(u=>((u==null?void 0:u.suites)||[]).forEach(f)),R(x)}}}catch{}try{const i=await fetch("/coverage/coverage-summary.json",{cache:"no-store"});a&&i.ok&&D(await i.json())}catch{}})(),()=>{a=!1}},[]);const E={border:"1px solid rgba(148,163,184,0.25)",borderRadius:12,padding:16,background:"rgba(2,6,23,0.9)",color:"#e5e7eb"},F={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:12},g={fontWeight:800,marginBottom:8},p={fontSize:12,color:"#94a3b8"};return e.createElement("div",null,e.createElement("div",{style:F},e.createElement("div",{style:E},e.createElement("div",{style:g},"Unit Tests (Jest)"),t?e.createElement("div",null,e.createElement("div",{style:p},"generated: ",t.startTime?new Date(t.startTime).toLocaleString():"n/a"),t.numTotalTests!=null?e.createElement("ul",null,e.createElement("li",null,"Total: ",t.numTotalTests),e.createElement("li",null,"Passed: ",t.numPassedTests),e.createElement("li",null,"Failed: ",t.numFailedTests),e.createElement("li",null,"Pending: ",t.numPendingTests),e.createElement("li",null,"Runtime: ",((w=(T=(j=t==null?void 0:t.testResults)==null?void 0:j[0])==null?void 0:T.perfStats)==null?void 0:w.runtime)??"—"," ms")):e.createElement("div",null,"No structured summary fields found."),e.createElement("div",{style:{marginTop:8}},"Tip: npm run test:unit:json")):e.createElement("div",null,"No jest-summary.json found at /data/tests/jest-summary.json",e.createElement("div",{style:{marginTop:8}},"Run: npm run test:unit:json"))),e.createElement("div",{style:E},e.createElement("div",{style:g},"E2E Tests (Playwright)"),o?e.createElement("div",null,e.createElement("div",{style:p},"generated: ",o.generatedAt?new Date(o.generatedAt).toLocaleString():"n/a"),o.totals?e.createElement("ul",null,e.createElement("li",null,"Total: ",o.totals.total),e.createElement("li",null,"Passed: ",o.totals.passed),e.createElement("li",null,"Failed: ",o.totals.failed),e.createElement("li",null,"Flaky: ",o.totals.flaky),e.createElement("li",null,"Skipped: ",o.totals.skipped)):e.createElement("div",null,"No totals present. ",o.note||""),y.length>0&&e.createElement("div",{style:{marginTop:8}},e.createElement("div",{style:{...p,marginBottom:4}},"Failed specs"),e.createElement("ul",null,y.slice(0,10).map((a,i)=>e.createElement("li",{key:i},e.createElement("strong",null,a.title),a.file?e.createElement("span",{style:p}," — ",a.file):null,a.error?e.createElement("div",{style:{whiteSpace:"pre-wrap",marginTop:4}},a.error):null))),y.length>10&&e.createElement("div",{style:p},"…and ",y.length-10," more")),e.createElement("div",{style:{marginTop:8}},e.createElement("a",{href:"/reports/playwright/index.html",target:"_blank",rel:"noreferrer"},"Open Playwright HTML Report")),e.createElement("div",{style:{marginTop:8}},"Tip: npm run test:e2e:json or npm run e2e:ensure-summary")):e.createElement("div",null,"No playwright-summary.json found at /data/tests/playwright-summary.json",e.createElement("div",{style:{marginTop:8}},"Run: npm run test:e2e:json or npm run e2e:ensure-summary"))),e.createElement("div",{style:E},e.createElement("div",{style:g},"Coverage"),s?e.createElement("div",null,s.total?e.createElement("ul",null,e.createElement("li",null,"Statements: ",s.total.statements.pct,"% (",s.total.statements.covered,"/",s.total.statements.total,")"),e.createElement("li",null,"Branches: ",s.total.branches.pct,"% (",s.total.branches.covered,"/",s.total.branches.total,")"),e.createElement("li",null,"Functions: ",s.total.functions.pct,"% (",s.total.functions.covered,"/",s.total.functions.total,")"),e.createElement("li",null,"Lines: ",s.total.lines.pct,"% (",s.total.lines.covered,"/",s.total.lines.total,")")):e.createElement("div",null,"No coverage-summary.json found at /coverage/coverage-summary.json"),e.createElement("div",{style:{marginTop:8}},"Tip: npm run test:coverage")):e.createElement("div",null,"No coverage-summary.json found at /coverage/coverage-summary.json",e.createElement("div",{style:{marginTop:8}},"Run: npm run test:coverage")))))},q={devOnly:!0};function k(t){const r={h1:"h1",li:"li",p:"p",ul:"ul",...P(),...t.components};return n.jsxs(n.Fragment,{children:[n.jsx(J,{title:"Dev/Tests Dashboard"}),`
`,`
`,n.jsx(r.h1,{id:"tests-dashboard",children:"Tests Dashboard"}),`
`,n.jsx(r.p,{children:"This dashboard surfaces recent unit test (Jest) and E2E (Playwright) results, plus coverage, directly inside Storybook."}),`
`,n.jsx(r.p,{children:"How to refresh results"}),`
`,n.jsxs(r.ul,{children:[`
`,n.jsx(r.li,{children:"Unit (Jest JSON summary): npm run test:unit:json"}),`
`,n.jsx(r.li,{children:"E2E (Playwright JSON summary): npm run test:e2e:json or npm run e2e:ensure-summary"}),`
`,n.jsx(r.li,{children:"Coverage: npm run test:coverage"}),`
`]}),`
`,n.jsx(r.p,{children:"Playwright HTML report"}),`
`,n.jsxs(r.ul,{children:[`
`,n.jsxs(r.li,{children:["After E2E tests, open the full report here:",`
`,n.jsxs(r.ul,{children:[`
`,n.jsx(r.li,{children:"/reports/playwright/index.html"}),`
`]}),`
`]}),`
`]}),`
`,n.jsx(L,{})]})}function G(t={}){const{wrapper:r}={...P(),...t.components};return r?n.jsx(r,{...t,children:n.jsx(k,{...t})}):k(t)}export{G as default,q as parameters};
